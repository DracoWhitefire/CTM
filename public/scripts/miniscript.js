function findClass(a,b,d){var c=String(a.className).split(" ");-1===c.indexOf(b)?"add"===d?(c.push(b),b=!0):b=!1:"del"===d?(c.splice(c.indexOf(b),1),b=!0):b="find"===d?!0:!1;a.className=c.join(" ");return b}function changeAnchorTargets(a){if(a instanceof HTMLCollection){for(i=0;i<a.length;i++)a[i].setAttribute("href","#");return!0}} function addHiddenDateInputs(a,b){ySelect=document.createElement("input");ySelect.setAttribute("type","hidden");ySelect.setAttribute("name","y");ySelect.setAttribute("value",b.getFullYear());a.appendChild(ySelect);mSelect=document.createElement("input");mSelect.setAttribute("type","hidden");mSelect.setAttribute("name","m");mSelect.setAttribute("value",b.getMonth()+1);a.appendChild(mSelect);dSelect=document.createElement("input");dSelect.setAttribute("type","hidden");dSelect.setAttribute("name","d"); dSelect.setAttribute("value",b.getDate());a.appendChild(dSelect)} function changeSelectedDay(a){for(i=0;i<a.length;i++)a[i].onclick=function(){for(i=0;i<a.length;i++){var b=this.parentNode.parentNode.parentNode.getElementsByTagName("div");for(i=0;i<b.length;i++)findClass(b[i],"selectedDay","del")}findClass(this.parentNode,"selectedDay","add");selectedDateDiv=document.getElementById("calCur_div");date=getSelectedDay();date.setDate(this.textContent);selectedDateDiv.textContent=date.getDate()+" "+"January February March April May June July August September October November December".split(" ")[date.getMonth()]+" "+ date.getFullYear()}}function getSelectedDay(){selectedDateDiv=document.getElementById("calCur_div");selectedDateArray=selectedDateDiv.textContent.split(" ");selectedDay=selectedDateArray[0];selectedMonth=selectedDateArray[1];selectedYear=selectedDateArray[2];return new Date(selectedDay+" "+selectedMonth+" "+selectedYear)} function changeMonthNav(a,b){splitString=a.id.replace(/([A-Z])/,"_$1");nameArray=splitString.split("_");date=getSelectedDay();submitButton=addSubmit(a,nameArray[1],nameArray[1]);"Next"===nameArray[1]?submitButton.onclick=function(){date.setMonth(date.getMonth()+1);addHiddenDateInputs(a,date)}:"Prev"===nameArray[1]&&(submitButton.onclick=function(){date.setMonth(date.getMonth()-1);addHiddenDateInputs(a,date)});anchor=a.getElementsByTagName("a");for(i=0;i<anchor.length;i++)a.removeChild(anchor[i])} function disableOtherMonthDays(a){for(i=0;i<a.length;i++)if(findClass(a[i].parentNode,"prevMonth","find")||findClass(a[i].parentNode,"nextMonth","find")){foundNode=a[i];var b=document.createTextNode(a[i].textContent);foundNode.parentNode.appendChild(b);foundNode.parentNode.removeChild(foundNode);i--}} function convertToForm(a){var b=document.createElement("form");b.setAttribute("id","date_selector");b.setAttribute("method","POST");b.setAttribute("action",document.location.href);var d=[];for(i=0;i<a.childNodes.length;i++)d.push(a.childNodes[i]);for(i=0;i<d.length;i++)childNode=a.removeChild(d[i]),b.appendChild(childNode);a.appendChild(b);return b} function addSubmit(a,b,d){var c=document.createElement("input");c.setAttribute("type","submit");c.setAttribute("value",d);c.setAttribute("name",b);a.appendChild(c);return c}function addChooser(a){submitButton=addSubmit(a,"dateSubmit","Choose");submitButton.onclick=function(){date=getSelectedDay();addHiddenDateInputs(a,date)}} var dateSelectorDiv=document.getElementById("calendar_div"),daySelectorDiv=document.getElementById("daySelect_div"),dayLinks=daySelectorDiv.getElementsByTagName("a"),calPrevDiv=document.getElementById("calPrev_div"),calNextDiv=document.getElementById("calNext_div");window.onload=function(){changeAnchorTargets(dayLinks);changeSelectedDay(dayLinks);disableOtherMonthDays(dayLinks);selectionForm=convertToForm(dateSelectorDiv);changeMonthNav(calPrevDiv);changeMonthNav(calNextDiv);addChooser(selectionForm)};