function findClass(b,a,c){var d=String(b.className).split(" ");-1===d.indexOf(a)?"add"===c?(d.push(a),a=!0):a=!1:"del"===c?(d.splice(d.indexOf(a),1),a=!0):a="find"===c?!0:!1;b.className=d.join(" ");return a}function changeAnchorTargets(b){if(b instanceof HTMLCollection){for(i=0;i<b.length;i++)b[i].setAttribute("href","#");return!0}} function addHiddenDateInputs(b,a){var c=document.createElement("input");c.setAttribute("type","hidden");c.setAttribute("name","y");c.setAttribute("value",a.getFullYear());b.appendChild(c);c=document.createElement("input");c.setAttribute("type","hidden");c.setAttribute("name","m");c.setAttribute("value",a.getMonth()+1);b.appendChild(c);c=document.createElement("input");c.setAttribute("type","hidden");c.setAttribute("name","d");c.setAttribute("value",a.getDate());b.appendChild(c)} function changeSelectedDay(b){for(i=0;i<b.length;i++)b[i].onclick=function(){for(i=0;i<b.length;i++){var a=this.parentNode.parentNode.parentNode.getElementsByTagName("div");for(i=0;i<a.length;i++)findClass(a[i],"selectedDay","del")}findClass(this.parentNode,"selectedDay","add");var a=document.getElementById("calCur_div"),c=getSelectedDay();c.setDate(this.textContent);a.textContent=c.getDate()+" "+"January February March April May June July August September October November December".split(" ")[c.getMonth()]+ " "+c.getFullYear()}}function getSelectedDay(){var b=document.getElementById("calCur_div").textContent.split(" ");return new Date(b[0]+" "+b[1]+" "+b[2])} function changeMonthNav(b){var a=b.id.replace(/([A-Z])/,"_$1").split("_"),c=getSelectedDay(),d=addSubmit(b,a[1],a[1]);"Next"===a[1]?d.onclick=function(){c.setMonth(c.getMonth()+1);addHiddenDateInputs(b,c)}:"Prev"===a[1]&&(d.onclick=function(){c.setMonth(c.getMonth()-1);addHiddenDateInputs(b,c)});a=b.getElementsByTagName("a");for(i=0;i<a.length;i++)b.removeChild(a[i])} function disableOtherMonthDays(b){for(i=0;i<b.length;i++)if(findClass(b[i].parentNode,"prevMonth","find")||findClass(b[i].parentNode,"nextMonth","find")){var a=b[i],c=document.createTextNode(b[i].textContent);a.parentNode.appendChild(c);a.parentNode.removeChild(a);i--}} function convertToForm(b){var a=document.createElement("form");a.setAttribute("id","date_selector");a.setAttribute("method","POST");a.setAttribute("action",document.location.href);var c=[];for(i=0;i<b.childNodes.length;i++)c.push(b.childNodes[i]);for(i=0;i<c.length;i++){var d=b.removeChild(c[i]);a.appendChild(d)}b.appendChild(a);return a} function addSubmit(b,a,c){var d=document.createElement("input");d.setAttribute("type","submit");d.setAttribute("value",c);d.setAttribute("name",a);b.appendChild(d);return d}function addChooser(b){var a=addSubmit(b,"dateSubmit","Choose");a.onclick=function(){var a=getSelectedDay();addHiddenDateInputs(b,a)};return a} var dateSelectorDiv=document.getElementById("calendar_div"),daySelectorDiv=document.getElementById("day_select"),dayLinks=daySelectorDiv.getElementsByTagName("a"),calPrevDiv=document.getElementById("calPrev_div"),calNextDiv=document.getElementById("calNext_div");changeAnchorTargets(dayLinks);changeSelectedDay(dayLinks);disableOtherMonthDays(dayLinks);var selectionForm=convertToForm(dateSelectorDiv);changeMonthNav(calPrevDiv);changeMonthNav(calNextDiv);addChooser(selectionForm);